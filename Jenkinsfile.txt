stage('save-artifacts'){
		 archiveArtifacts artifacts: 'target/*.war'
            echo 'Archiving Completed'
		def server = Artifactory.server 'jfrog'
		def buildinfo = Artifactory.newBuildInfo()        
            
            //server.bypassProxy = true
            server.username = 'admin'
            server.password = 'admin'
            server.connection.timeout = 300
	    
	    	

            def uploadSpec = """{
                "files": [
                {
                "pattern": "target/*.war",
                "target": "maven/"
                }
                ]
                }"""
            server.upload spec: uploadSpec
			
            def downloadSpec = """{
                "files": [
                {
                "pattern": "/target/*.war",
                "target": "libs-release-local/"
                }
                ]
                }"""
            server.download spec: downloadSpec

            def buildInfo1 = server.download downloadSpec
            def buildInfo2 = server.upload uploadSpec
            buildInfo1.append buildInfo2
            server.publishBuildInfo buildInfo1

            def buildInfo = Artifactory.newBuildInfo()
            server.download spec: downloadSpec, buildInfo: buildInfo
            server.upload spec: uploadSpec, buildInfo: buildInfo
            server.publishBuildInfo buildInfo
            buildInfo.env.capture = true      
                    
        }
